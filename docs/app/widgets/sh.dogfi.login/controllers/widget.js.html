<!DOCTYPE html><html><head><title>widget.js</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="../../../../docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="../../../../index.html" class="source"><span class="file_name">README</span></a><a href="../../../../app/alloy.js.html" class="source "><span class="base_path">app / </span><span class="file_name">alloy.js</span></a><a href="../../../../app/assets/specs/interpreterModule/interpreterModule.js.html" class="source "><span class="base_path">app / assets / specs / interpreterModule / </span><span class="file_name">interpreterModule.js</span></a><a href="../../../../app/assets/specs/LocalDataHandler/localDataHandler.js.html" class="source "><span class="base_path">app / assets / specs / LocalDataHandler / </span><span class="file_name">localDataHandler.js</span></a><a href="../../../../app/assets/specs/Parser/parserSpec.js.html" class="source "><span class="base_path">app / assets / specs / Parser / </span><span class="file_name">parserSpec.js</span></a><a href="../../../../app/assets/specs/ResponseGenerator/responseGenerator.js.html" class="source "><span class="base_path">app / assets / specs / ResponseGenerator / </span><span class="file_name">responseGenerator.js</span></a><a href="../../../../app/assets/specs/Soap/soapSpec.js.html" class="source "><span class="base_path">app / assets / specs / Soap / </span><span class="file_name">soapSpec.js</span></a><a href="../../../../app/assets/specs/User/userSpec.js.html" class="source "><span class="base_path">app / assets / specs / User / </span><span class="file_name">userSpec.js</span></a><a href="../../../../app/assets/specs/Validator/validatorSpec.js.html" class="source "><span class="base_path">app / assets / specs / Validator / </span><span class="file_name">validatorSpec.js</span></a><a href="../../../../app/controllers/appHelp.js.html" class="source "><span class="base_path">app / controllers / </span><span class="file_name">appHelp.js</span></a><a href="../../../../app/controllers/censusFooterView.js.html" class="source "><span class="base_path">app / controllers / </span><span class="file_name">censusFooterView.js</span></a><a href="../../../../app/controllers/customRiskAssessmentRows/setEntireSectionTemplate.js.html" class="source "><span class="base_path">app / controllers / customRiskAssessmentRows / </span><span class="file_name">setEntireSectionTemplate.js</span></a><a href="../../../../app/controllers/customRiskAssessmentRows/subsectionHeaderTemplate.js.html" class="source "><span class="base_path">app / controllers / customRiskAssessmentRows / </span><span class="file_name">subsectionHeaderTemplate.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/censusSelect/addCensusView.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / censusSelect / </span><span class="file_name">addCensusView.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/censusSelect/selectCensusView.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / censusSelect / </span><span class="file_name">selectCensusView.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/detailRowHeaderTemplate.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">detailRowHeaderTemplate.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/detailRowQuestionTemplate.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">detailRowQuestionTemplate.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/detailRowSection.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">detailRowSection.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/goToQuestionDetailView.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">goToQuestionDetailView.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/goToQuestionMasterView.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">goToQuestionMasterView.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/goToQuestionRow.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">goToQuestionRow.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/gotoQuestionSectionWindow.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">gotoQuestionSectionWindow.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/goToSectionHeader.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">goToSectionHeader.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/masterCensusDesktopCompleteTemplate.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">masterCensusDesktopCompleteTemplate.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/masterCensusRowTemplate.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">masterCensusRowTemplate.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/masterRowTemplate.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">masterRowTemplate.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/riskAssessmentPageRowTemplate.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">riskAssessmentPageRowTemplate.js</span></a><a href="../../../../app/controllers/gotoQuestionSectionWindow/sectionRow.js.html" class="source "><span class="base_path">app / controllers / gotoQuestionSectionWindow / </span><span class="file_name">sectionRow.js</span></a><a href="../../../../app/controllers/index.js.html" class="source "><span class="base_path">app / controllers / </span><span class="file_name">index.js</span></a><a href="../../../../app/controllers/main.js.html" class="source "><span class="base_path">app / controllers / </span><span class="file_name">main.js</span></a><a href="../../../../app/controllers/questionDialogs/minuteHourTimePicker.js.html" class="source "><span class="base_path">app / controllers / questionDialogs / </span><span class="file_name">minuteHourTimePicker.js</span></a><a href="../../../../app/controllers/questionDialogs/modalDatePicker.js.html" class="source "><span class="base_path">app / controllers / questionDialogs / </span><span class="file_name">modalDatePicker.js</span></a><a href="../../../../app/controllers/questionDialogs/modalMultiPicker.js.html" class="source "><span class="base_path">app / controllers / questionDialogs / </span><span class="file_name">modalMultiPicker.js</span></a><a href="../../../../app/controllers/questionDialogs/modalPicker.js.html" class="source "><span class="base_path">app / controllers / questionDialogs / </span><span class="file_name">modalPicker.js</span></a><a href="../../../../app/controllers/questionDialogs/userNotesDialog.js.html" class="source "><span class="base_path">app / controllers / questionDialogs / </span><span class="file_name">userNotesDialog.js</span></a><a href="../../../../app/controllers/questionRenderer.js.html" class="source "><span class="base_path">app / controllers / </span><span class="file_name">questionRenderer.js</span></a><a href="../../../../app/controllers/questionRendererTab.js.html" class="source "><span class="base_path">app / controllers / </span><span class="file_name">questionRendererTab.js</span></a><a href="../../../../app/controllers/questionSectionHeader.js.html" class="source "><span class="base_path">app / controllers / </span><span class="file_name">questionSectionHeader.js</span></a><a href="../../../../app/controllers/questionSectionNavigation.js.html" class="source "><span class="base_path">app / controllers / </span><span class="file_name">questionSectionNavigation.js</span></a><a href="../../../../app/controllers/questionTemplates/censusCounterTemplate.js.html" class="source "><span class="base_path">app / controllers / questionTemplates / </span><span class="file_name">censusCounterTemplate.js</span></a><a href="../../../../app/controllers/questionTemplates/censusStartTimerTemplate.js.html" class="source "><span class="base_path">app / controllers / questionTemplates / </span><span class="file_name">censusStartTimerTemplate.js</span></a><a href="../../../../app/controllers/questionTemplates/dateRangeTemplate.js.html" class="source "><span class="base_path">app / controllers / questionTemplates / </span><span class="file_name">dateRangeTemplate.js</span></a><a href="../../../../app/controllers/questionTemplates/dateSelectTemplate.js.html" class="source "><span class="base_path">app / controllers / questionTemplates / </span><span class="file_name">dateSelectTemplate.js</span></a><a href="../../../../app/controllers/questionTemplates/minuteHourTimeTemplate.js.html" class="source "><span class="base_path">app / controllers / questionTemplates / </span><span class="file_name">minuteHourTimeTemplate.js</span></a><a href="../../../../app/controllers/questionTemplates/multiSelectTemplate.js.html" class="source "><span class="base_path">app / controllers / questionTemplates / </span><span class="file_name">multiSelectTemplate.js</span></a><a href="../../../../app/controllers/questionTemplates/rangeFieldTemplate.js.html" class="source "><span class="base_path">app / controllers / questionTemplates / </span><span class="file_name">rangeFieldTemplate.js</span></a><a href="../../../../app/controllers/questionTemplates/singleSelectTemplate.js.html" class="source "><span class="base_path">app / controllers / questionTemplates / </span><span class="file_name">singleSelectTemplate.js</span></a><a href="../../../../app/controllers/questionTemplates/textFieldTemplate.js.html" class="source "><span class="base_path">app / controllers / questionTemplates / </span><span class="file_name">textFieldTemplate.js</span></a><a href="../../../../app/controllers/riskAssessments/commitMessageView.js.html" class="source "><span class="base_path">app / controllers / riskAssessments / </span><span class="file_name">commitMessageView.js</span></a><a href="../../../../app/controllers/riskAssessments/riskAssessmentsWindow.js.html" class="source "><span class="base_path">app / controllers / riskAssessments / </span><span class="file_name">riskAssessmentsWindow.js</span></a><a href="../../../../app/controllers/riskAssessments/riskAssessmentTableRow.js.html" class="source "><span class="base_path">app / controllers / riskAssessments / </span><span class="file_name">riskAssessmentTableRow.js</span></a><a href="../../../../app/controllers/searchWindow/masterSearchTab.js.html" class="source "><span class="base_path">app / controllers / searchWindow / </span><span class="file_name">masterSearchTab.js</span></a><a href="../../../../app/controllers/searchWindow/masterSearchTableRow.js.html" class="source "><span class="base_path">app / controllers / searchWindow / </span><span class="file_name">masterSearchTableRow.js</span></a><a href="../../../../app/controllers/selectRouteWindow.js.html" class="source "><span class="base_path">app / controllers / </span><span class="file_name">selectRouteWindow.js</span></a><a href="../../../../app/controllers/startup.js.html" class="source "><span class="base_path">app / controllers / </span><span class="file_name">startup.js</span></a><a href="../../../../app/controllers/userNotificationWindows/activityIndicatorDialog.js.html" class="source "><span class="base_path">app / controllers / userNotificationWindows / </span><span class="file_name">activityIndicatorDialog.js</span></a><a href="../../../../app/controllers/userSettings.js.html" class="source "><span class="base_path">app / controllers / </span><span class="file_name">userSettings.js</span></a><a href="../../../../app/lib/core/Analytics.js.html" class="source "><span class="base_path">app / lib / core / </span><span class="file_name">Analytics.js</span></a><a href="../../../../app/lib/core/Logger.js.html" class="source "><span class="base_path">app / lib / core / </span><span class="file_name">Logger.js</span></a><a href="../../../../app/lib/core/Soap.js.html" class="source "><span class="base_path">app / lib / core / </span><span class="file_name">Soap.js</span></a><a href="../../../../app/lib/core/Soap_FAT.js.html" class="source "><span class="base_path">app / lib / core / </span><span class="file_name">Soap_FAT.js</span></a><a href="../../../../app/lib/core/Ui.js.html" class="source "><span class="base_path">app / lib / core / </span><span class="file_name">Ui.js</span></a><a href="../../../../app/lib/core/User.js.html" class="source "><span class="base_path">app / lib / core / </span><span class="file_name">User.js</span></a><a href="../../../../app/lib/core/Util.js.html" class="source "><span class="base_path">app / lib / core / </span><span class="file_name">Util.js</span></a><a href="../../../../app/lib/interpreter/interpreterModule2.js.html" class="source "><span class="base_path">app / lib / interpreter / </span><span class="file_name">interpreterModule2.js</span></a><a href="../../../../app/lib/localDataHandler/localDataHandler.js.html" class="source "><span class="base_path">app / lib / localDataHandler / </span><span class="file_name">localDataHandler.js</span></a><a href="../../../../app/lib/parser/localParser.js.html" class="source "><span class="base_path">app / lib / parser / </span><span class="file_name">localParser.js</span></a><a href="../../../../app/lib/responseGenerator/responseGenerator.js.html" class="source "><span class="base_path">app / lib / responseGenerator / </span><span class="file_name">responseGenerator.js</span></a><a href="../../../../app/lib/styles/styles.js.html" class="source "><span class="base_path">app / lib / styles / </span><span class="file_name">styles.js</span></a><a href="../../../../app/lib/test-framework/jasmine.js.html" class="source "><span class="base_path">app / lib / test-framework / </span><span class="file_name">jasmine.js</span></a><a href="../../../../app/lib/test-framework/tijasmine-console.js.html" class="source "><span class="base_path">app / lib / test-framework / </span><span class="file_name">tijasmine-console.js</span></a><a href="../../../../app/lib/test-framework/tijasmine.js.html" class="source "><span class="base_path">app / lib / test-framework / </span><span class="file_name">tijasmine.js</span></a><a href="../../../../app/lib/tests_runner.js.html" class="source "><span class="base_path">app / lib / </span><span class="file_name">tests_runner.js</span></a><a href="../../../../app/lib/tools/fonts/FontAwesome.js.html" class="source "><span class="base_path">app / lib / tools / fonts / </span><span class="file_name">FontAwesome.js</span></a><a href="../../../../app/lib/tools/fonts/IconicFont.js.html" class="source "><span class="base_path">app / lib / tools / fonts / </span><span class="file_name">IconicFont.js</span></a><a href="../../../../app/lib/tools/randexp.js.html" class="source "><span class="base_path">app / lib / tools / </span><span class="file_name">randexp.js</span></a><a href="../../../../app/lib/tools/ret/index.js.html" class="source "><span class="base_path">app / lib / tools / ret / </span><span class="file_name">index.js</span></a><a href="../../../../app/lib/tools/ret/positions.js.html" class="source "><span class="base_path">app / lib / tools / ret / </span><span class="file_name">positions.js</span></a><a href="../../../../app/lib/tools/ret/sets.js.html" class="source "><span class="base_path">app / lib / tools / ret / </span><span class="file_name">sets.js</span></a><a href="../../../../app/lib/tools/ret/types.js.html" class="source "><span class="base_path">app / lib / tools / ret / </span><span class="file_name">types.js</span></a><a href="../../../../app/lib/tools/ret/util.js.html" class="source "><span class="base_path">app / lib / tools / ret / </span><span class="file_name">util.js</span></a><a href="../../../../app/lib/tools/Suds2_fat.js.html" class="source "><span class="base_path">app / lib / tools / </span><span class="file_name">Suds2_fat.js</span></a><a href="../../../../app/lib/validator/Validator.js.html" class="source "><span class="base_path">app / lib / validator / </span><span class="file_name">Validator.js</span></a><a href="../../../../app/widgets/sh.dogfi.login/controllers/widget.js.html" class="source selected"><span class="base_path">app / widgets / sh.dogfi.login / controllers / </span><span class="file_name">widget.js</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>widget.js</h1><div class="filepath">app/widgets/sh.dogfi.login/controllers/</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div><p>Get orientation on load to assign right bg image
get max width and height</p>
</td><td class="code"><div class="highlight"><pre><span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Util</span><span class="p">.</span><span class="nx">downloadConfig</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">pWidth</span> <span class="o">=</span> <span class="nx">Ti</span><span class="p">.</span><span class="nx">Platform</span><span class="p">.</span><span class="nx">displayCaps</span><span class="p">.</span><span class="nx">platformWidth</span><span class="p">,</span>
    <span class="nx">pHeight</span> <span class="o">=</span> <span class="nx">Ti</span><span class="p">.</span><span class="nx">Platform</span><span class="p">.</span><span class="nx">displayCaps</span><span class="p">.</span><span class="nx">platformHeight</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">pWidth</span> <span class="o">&gt;</span> <span class="nx">pHeight</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><p>landscape</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">$</span><span class="p">.</span><span class="nx">loginWin</span><span class="p">.</span><span class="nx">backgroundImage</span> <span class="o">=</span> <span class="nx">WPATH</span><span class="p">(</span><span class="s1">&#39;images/bg/landscape.jpg&#39;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><p>portrait</p>
</td><td class="code"><div class="highlight"><pre>    <span class="nx">$</span><span class="p">.</span><span class="nx">loginWin</span><span class="p">.</span><span class="nx">backgroundImage</span> <span class="o">=</span> <span class="nx">WPATH</span><span class="p">(</span><span class="s1">&#39;images/bg/portrait.jpg&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">changeBg</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">isLandscape</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">loginWin</span><span class="p">.</span><span class="nx">backgroundImage</span> <span class="o">=</span> <span class="nx">WPATH</span><span class="p">(</span><span class="s1">&#39;images/bg/landscape.jpg&#39;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">loginWin</span><span class="p">.</span><span class="nx">backgroundImage</span> <span class="o">=</span> <span class="nx">WPATH</span><span class="p">(</span><span class="s1">&#39;images/bg/portrait.jpg&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">Ti</span><span class="p">.</span><span class="nx">Gesture</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;orientationchange&#39;</span><span class="p">,</span> <span class="nx">changeBg</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">doLogin</span><span class="p">()</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">offlineLogin</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">aIndicator</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="s1">&#39;Logging in...&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Titanium</span><span class="p">.</span><span class="nx">Network</span><span class="p">.</span><span class="nx">online</span> <span class="o">&amp;&amp;</span> <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">activeUser</span><span class="p">())</span> <span class="p">{</span>
        <span class="nx">offlineLogin</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Titanium</span><span class="p">.</span><span class="nx">Network</span><span class="p">.</span><span class="nx">online</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">aIndicator</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
        <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Util</span><span class="p">.</span><span class="nx">showAlert</span><span class="p">(</span><span class="s1">&#39;Please make sure that you are connected to the Internet&#39;</span><span class="p">);</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Titanium</span><span class="p">.</span><span class="nx">Network</span><span class="p">.</span><span class="nx">online</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">offlineLogin</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">aIndicator</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
        <span class="kd">var</span> <span class="nx">alertDialog</span> <span class="o">=</span> <span class="nx">Titanium</span><span class="p">.</span><span class="nx">UI</span><span class="p">.</span><span class="nx">createAlertDialog</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="nx">L</span><span class="p">(</span><span class="s1">&#39;no_connectivity_title&#39;</span><span class="p">),</span>
            <span class="nx">message</span><span class="o">:</span> <span class="nx">L</span><span class="p">(</span><span class="s1">&#39;no_connectivity_body&#39;</span><span class="p">),</span>
            <span class="nx">buttonNames</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;OK&#39;</span><span class="p">]</span>
        <span class="p">});</span>
        <span class="nx">alertDialog</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">loginError</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><p>Performs an animation and displays an error message</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">aIndicator</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
        <span class="kd">var</span> <span class="nx">animation</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;alloy/animation&#39;</span><span class="p">);</span>
        <span class="nx">animation</span><span class="p">.</span><span class="nx">shake</span><span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">loginView</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Util</span><span class="p">.</span><span class="nx">showAlert</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
            <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">);</span>

        <span class="p">});</span>

    <span class="p">};</span></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><p>Get username and password</p>
</td><td class="code"><div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">userField</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
        <span class="nx">pass</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">passField</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">user</span> <span class="o">&amp;&amp;</span> <span class="nx">user</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">pass</span> <span class="o">&amp;&amp;</span> <span class="nx">pass</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><p>do the offline login method rather than going via the internet.</p>
</td><td class="code"><div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="nx">offlineLogin</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">offlineAttempt</span> <span class="o">=</span> <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">offlineLogin</span><span class="p">({</span>
                <span class="nx">username</span><span class="o">:</span> <span class="nx">user</span><span class="p">,</span>
                <span class="nx">password</span><span class="o">:</span> <span class="nx">pass</span>
            <span class="p">});</span>

            <span class="k">if</span> <span class="p">(</span><span class="nx">offlineAttempt</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><p>Remove the login fields now</p>
</td><td class="code"><div class="highlight"><pre>                <span class="nx">$</span><span class="p">.</span><span class="nx">loginWin</span><span class="p">.</span><span class="nx">removeAllChildren</span><span class="p">();</span>
                <span class="k">try</span> <span class="p">{</span>
                    <span class="nx">Ti</span><span class="p">.</span><span class="nx">Gesture</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">&#39;orientationchange&#39;</span><span class="p">,</span> <span class="nx">changeBg</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Logger</span><span class="p">.</span><span class="nx">logException</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
                <span class="p">}</span>

                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">CloseLogin</span><span class="p">();</span>
                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">Startup</span><span class="p">();</span>
                <span class="k">return</span><span class="p">;</span>

            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">aIndicator</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Util</span><span class="p">.</span><span class="nx">showAlert</span><span class="p">(</span><span class="nx">L</span><span class="p">(</span><span class="s1">&#39;wrong_user_pass&#39;</span><span class="p">));</span>
            <span class="p">}</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span></pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><p>Fire up loading indicator here</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Login button pressed&quot;</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">);</span></pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><p>Making sure both are valid entries</p>
</td><td class="code"><div class="highlight"><pre>        <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Soap</span><span class="p">.</span><span class="nx">login</span><span class="p">({</span>
                <span class="nx">name</span><span class="o">:</span> <span class="nx">user</span>
            <span class="p">},</span> <span class="nx">pass</span><span class="p">,</span>
            <span class="kd">function</span><span class="p">(</span><span class="nx">xmlDoc</span><span class="p">)</span> <span class="p">{</span>

                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Util</span><span class="p">.</span><span class="nx">convertJson</span><span class="p">(</span><span class="nx">Ti</span><span class="p">.</span><span class="nx">XML</span><span class="p">.</span><span class="nx">serializeToString</span><span class="p">(</span><span class="nx">xmlDoc</span><span class="p">),</span>
                    <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><p>callback</p>
</td><td class="code"><div class="highlight"><pre>                        <span class="kd">var</span> <span class="nx">loginObject</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
                        <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;loginObject &gt;&gt; &quot;</span> <span class="o">+</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">loginObject</span><span class="p">),</span> <span class="s2">&quot;info&quot;</span><span class="p">);</span>

                        <span class="nx">$</span><span class="p">.</span><span class="nx">loginButton</span><span class="p">.</span><span class="nx">touchEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
                        <span class="kd">var</span> <span class="nx">accessCode</span> <span class="o">=</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">loginObject</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">Envelope</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">GetUserResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">access</span><span class="p">);</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">accessCode</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><p>Error - No access rights! </p>
</td><td class="code"><div class="highlight"><pre>                            <span class="nx">loginError</span><span class="p">(</span><span class="nx">L</span><span class="p">(</span><span class="s1">&#39;invalid_login&#39;</span><span class="p">));</span>
                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><p>Will return a boolean if the route 
passed in is turned on in the CMS
if returnenabledroutes is true then
this function will return routes applicable
to the user that are allowed in the CMS</p>
</td><td class="code"><div class="highlight"><pre>                            <span class="kd">var</span> <span class="nx">isRouteEnabled</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">routes</span><span class="p">,</span> <span class="nx">returnEnabledRoutes</span><span class="p">)</span> <span class="p">{</span>
                                <span class="kd">var</span> <span class="nx">rollOutRoutesArray</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">Ti</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">Properties</span><span class="p">.</span><span class="nx">getString</span><span class="p">(</span><span class="s1">&#39;stagedRollOutRoutes&#39;</span><span class="p">));</span>
                                <span class="kd">var</span> <span class="nx">rollOutRoutes</span> <span class="o">=</span> <span class="p">[];</span>
                                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">rollOutRoutesArray</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">rollOutRoutes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">rollOutRoutesArray</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                                <span class="p">}</span>
                                <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">routes</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-13"><td class="docs"><div class="pilwrap"><a href="#section-13" class="pilcrow">&#182;</a></div><p>Route returned by WS is a string</p>
</td><td class="code"><div class="highlight"><pre>                                    <span class="k">if</span> <span class="p">(</span><span class="nx">rollOutRoutes</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">routes</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                                        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
                                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
                                    <span class="p">}</span>
                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div></td></tr><tr id="section-14"><td class="docs"><div class="pilwrap"><a href="#section-14" class="pilcrow">&#182;</a></div><p>Route returned by WS is an array</p>
</td><td class="code"><div class="highlight"><pre>                                    <span class="kd">var</span> <span class="nx">rollOutLength</span> <span class="o">=</span> <span class="nx">rollOutRoutes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
                                    <span class="k">while</span> <span class="p">(</span><span class="nx">rollOutLength</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
                                        <span class="k">if</span> <span class="p">(</span><span class="nx">routes</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">rollOutRoutes</span><span class="p">[</span><span class="nx">rollOutLength</span><span class="p">])</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                                            <span class="nx">rollOutRoutes</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">rollOutLength</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                                        <span class="p">}</span>
                                    <span class="p">}</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="nx">returnEnabledRoutes</span><span class="p">)</span> <span class="p">{</span>
                                        <span class="k">return</span> <span class="nx">rollOutRoutes</span><span class="p">;</span>
                                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                        <span class="k">if</span> <span class="p">(</span><span class="nx">rollOutRoutes</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                                            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
                                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
                                        <span class="p">}</span>
                                    <span class="p">}</span>
                                <span class="p">}</span>
                            <span class="p">};</span></pre></div></td></tr><tr id="section-15"><td class="docs"><div class="pilwrap"><a href="#section-15" class="pilcrow">&#182;</a></div><p>Success Callback</p>
</td><td class="code"><div class="highlight"><pre>                            <span class="kd">var</span> <span class="nx">logTheUserIn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="nx">user</span><span class="p">,</span> <span class="nx">pass</span><span class="p">,</span> <span class="nx">access</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-16"><td class="docs"><div class="pilwrap"><a href="#section-16" class="pilcrow">&#182;</a></div><p>Remove the login fields now</p>
</td><td class="code"><div class="highlight"><pre>                                <span class="nx">$</span><span class="p">.</span><span class="nx">loginWin</span><span class="p">.</span><span class="nx">removeAllChildren</span><span class="p">();</span>

                                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Logger</span><span class="p">.</span><span class="nx">setUserName</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span></pre></div></td></tr><tr id="section-17"><td class="docs"><div class="pilwrap"><a href="#section-17" class="pilcrow">&#182;</a></div><p>Build out arguments object to check login</p>
</td><td class="code"><div class="highlight"><pre>                                <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="p">{</span>
                                    <span class="nx">username</span><span class="o">:</span> <span class="nx">user</span><span class="p">,</span>
                                    <span class="nx">password</span><span class="o">:</span> <span class="nx">pass</span><span class="p">,</span>
                                    <span class="nx">access</span><span class="o">:</span> <span class="nx">access</span><span class="p">,</span>
                                    <span class="nx">route</span><span class="o">:</span> <span class="nx">route</span>
                                <span class="p">};</span>

                                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">User</span><span class="p">.</span><span class="nx">setLogin</span><span class="p">(</span><span class="nx">args</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-18"><td class="docs"><div class="pilwrap"><a href="#section-18" class="pilcrow">&#182;</a></div><p>Success callback
Shows the home screen now</p>
</td><td class="code"><div class="highlight"><pre>                                    <span class="kd">var</span> <span class="nx">isStagedRollOutOn</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;alloy&#39;</span><span class="p">).</span><span class="nx">CFG</span><span class="p">.</span><span class="nx">stagedRollOut</span><span class="p">;</span>

                                    <span class="k">if</span> <span class="p">(</span><span class="nx">isStagedRollOutOn</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                                        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">route</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
                                            <span class="nx">Ti</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">Properties</span><span class="p">.</span><span class="nx">setString</span><span class="p">(</span><span class="s1">&#39;SelectedRoute&#39;</span><span class="p">,</span> <span class="nx">route</span><span class="p">);</span>
                                            <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">CloseLogin</span><span class="p">();</span>
                                            <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">Startup</span><span class="p">();</span>
                                        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                            <span class="kd">var</span> <span class="nx">rollOutRoutes</span> <span class="o">=</span> <span class="nx">isRouteEnabled</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
                                            <span class="k">if</span> <span class="p">(</span><span class="nx">rollOutRoutes</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                                                <span class="nx">Ti</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">Properties</span><span class="p">.</span><span class="nx">setString</span><span class="p">(</span><span class="s1">&#39;SelectedRoute&#39;</span><span class="p">,</span> <span class="nx">rollOutRoutes</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
                                                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">CloseLogin</span><span class="p">();</span>
                                                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">Startup</span><span class="p">();</span>
                                            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">createController</span><span class="p">(</span><span class="s1">&#39;selectRouteWindow&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">(</span><span class="nx">rollOutRoutes</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                                                    <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">CloseLogin</span><span class="p">();</span>
                                                    <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">Startup</span><span class="p">();</span>
                                                <span class="p">});</span>
                                            <span class="p">}</span>

                                        <span class="p">}</span>
                                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">route</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
                                            <span class="nx">Ti</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">Properties</span><span class="p">.</span><span class="nx">setString</span><span class="p">(</span><span class="s1">&#39;SelectedRoute&#39;</span><span class="p">,</span> <span class="nx">route</span><span class="p">);</span>
                                            <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">CloseLogin</span><span class="p">();</span>
                                            <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">Startup</span><span class="p">();</span>
                                        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">route</span><span class="p">))</span> <span class="p">{</span>
                                            <span class="k">if</span> <span class="p">(</span><span class="nx">route</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                                                <span class="nx">Ti</span><span class="p">.</span><span class="nx">App</span><span class="p">.</span><span class="nx">Properties</span><span class="p">.</span><span class="nx">setString</span><span class="p">(</span><span class="s1">&#39;SelectedRoute&#39;</span><span class="p">,</span> <span class="nx">route</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
                                                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">CloseLogin</span><span class="p">();</span>
                                                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">Startup</span><span class="p">();</span>
                                            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">createController</span><span class="p">(</span><span class="s1">&#39;selectRouteWindow&#39;</span><span class="p">).</span><span class="nx">show</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                                                    <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">CloseLogin</span><span class="p">();</span>
                                                    <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Index</span><span class="p">.</span><span class="nx">Startup</span><span class="p">();</span>
                                                <span class="p">});</span>
                                            <span class="p">}</span>

                                        <span class="p">}</span>
                                    <span class="p">}</span>

                                    <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">Analytics</span><span class="p">.</span><span class="nx">trackNav</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="s1">&#39;home&#39;</span><span class="p">,</span> <span class="s1">&#39;login:success&#39;</span><span class="p">);</span>

                                <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span></pre></div></td></tr><tr id="section-19"><td class="docs"><div class="pilwrap"><a href="#section-19" class="pilcrow">&#182;</a></div><p>Error - No access rights! </p>
</td><td class="code"><div class="highlight"><pre>                                    <span class="nx">loginError</span><span class="p">(</span><span class="s1">&#39;Login invalid - Access code is &#39;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">.</span><span class="nx">access</span> <span class="o">+</span> <span class="s1">&#39; and route returned is &#39;</span> <span class="o">+</span> <span class="nx">args</span><span class="p">.</span><span class="nx">route</span><span class="p">);</span>
                                <span class="p">});</span>
                            <span class="p">};</span>

                            <span class="kd">var</span> <span class="nx">access</span> <span class="o">=</span> <span class="nx">loginObject</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">Envelope</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">GetUserResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">access</span><span class="p">;</span>
                            <span class="nx">route</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

                            <span class="kd">var</span> <span class="nx">routeLength</span><span class="p">;</span></pre></div></td></tr><tr id="section-20"><td class="docs"><div class="pilwrap"><a href="#section-20" class="pilcrow">&#182;</a></div><p>22-08 - Multi-route login
Update for bugfix</p>
</td><td class="code"><div class="highlight"><pre>                            <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">loginObject</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">Envelope</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">GetUserResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">routes</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
                                <span class="nx">routeLength</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                <span class="nx">routeLength</span> <span class="o">=</span> <span class="nx">loginObject</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">Envelope</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">GetUserResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">routes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
                            <span class="p">}</span>

                            <span class="k">if</span> <span class="p">(</span><span class="nb">Number</span><span class="p">(</span><span class="nx">routeLength</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                                <span class="kd">var</span> <span class="nx">routes</span> <span class="o">=</span> <span class="p">[];</span>
                                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">routeLength</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">routes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">loginObject</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">Envelope</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">GetUserResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">routes</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
                                <span class="p">}</span>

                                <span class="k">if</span> <span class="p">(</span><span class="nx">Alloy</span><span class="p">.</span><span class="nx">CFG</span><span class="p">.</span><span class="nx">stagedRollOut</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="nx">isRouteEnabled</span><span class="p">(</span><span class="nx">routes</span><span class="p">))</span> <span class="p">{</span>
                                        <span class="nx">logTheUserIn</span><span class="p">(</span><span class="nx">routes</span><span class="p">.</span><span class="nx">sort</span><span class="p">(),</span> <span class="nx">user</span><span class="p">,</span> <span class="nx">pass</span><span class="p">,</span> <span class="nx">access</span><span class="p">);</span>
                                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                        <span class="nx">loginError</span><span class="p">(</span><span class="nx">L</span><span class="p">(</span><span class="s1">&#39;no_valid_routes&#39;</span><span class="p">));</span>
                                    <span class="p">}</span>
                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                    <span class="nx">logTheUserIn</span><span class="p">(</span><span class="nx">routes</span><span class="p">.</span><span class="nx">sort</span><span class="p">(),</span> <span class="nx">user</span><span class="p">,</span> <span class="nx">pass</span><span class="p">,</span> <span class="nx">access</span><span class="p">);</span>
                                <span class="p">}</span>

                            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">loginObject</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">Envelope</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">GetUserResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">routes</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="nx">route</span> <span class="o">=</span> <span class="nx">loginObject</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">Envelope</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">GetUserResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">routes</span><span class="p">;</span>
                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                    <span class="nx">route</span> <span class="o">=</span> <span class="nx">loginObject</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">Envelope</span><span class="p">.</span><span class="nx">Body</span><span class="p">.</span><span class="nx">GetUserResponse</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">routes</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="k">if</span> <span class="p">(</span><span class="nx">Alloy</span><span class="p">.</span><span class="nx">CFG</span><span class="p">.</span><span class="nx">stagedRollOut</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="nx">isRouteEnabled</span><span class="p">(</span><span class="nx">route</span><span class="p">))</span> <span class="p">{</span>
                                        <span class="nx">logTheUserIn</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="nx">user</span><span class="p">,</span> <span class="nx">pass</span><span class="p">,</span> <span class="nx">access</span><span class="p">);</span>
                                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                        <span class="nx">loginError</span><span class="p">(</span><span class="nx">L</span><span class="p">(</span><span class="s1">&#39;no_valid_routes&#39;</span><span class="p">));</span>
                                    <span class="p">}</span>
                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                    <span class="nx">logTheUserIn</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="nx">user</span><span class="p">,</span> <span class="nx">pass</span><span class="p">,</span> <span class="nx">access</span><span class="p">);</span>
                                <span class="p">}</span>

                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">);</span>
            <span class="p">},</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xmlDoc</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">Alloy</span><span class="p">.</span><span class="nx">Globals</span><span class="p">.</span><span class="nx">aIndicator</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
            <span class="p">});</span>

    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">loginError</span><span class="p">(</span><span class="nx">L</span><span class="p">(</span><span class="s1">&#39;enter_email_and_password&#39;</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">focusPassword</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">passField</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
<span class="p">}</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Mon Mar 24 2014 19:50:08 GMT+0000 (GMT)  </div></div></body></html>